<!DOCTYPE html>

<html>

<head>

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        var connectionData = {}
            //var chart = {}

        function prepend(value, array) {
            var newArray = array.slice(0);
            newArray.unshift(value);
            return newArray;
        }

        function drawChart() {
            var headers = [{
                label: 'X',
                id: 'X',
                type: 'datetime'
            }, {
                label: 'Ping',
                id: 'Ping',
                type: 'number'
            }, {
                label: 'Up',
                id: 'Up',
                type: 'number'
            }, {
                label: 'Down',
                id: 'Down',
                type: 'number'
            }];
            var data = google.visualization.arrayToDataTable(prepend(headers, connectionData))
            var options = {
                hAxis: {
                    title: 'Time'
                },
                vAxis: {
                    title: 'Internet Health'
                },
				focusTarget: 'category'
            };

            var chart = new google.visualization.LineChart(document.getElementById('chartContainer'));
            chart.draw(data, options);
        }

        $(document).ready(function() {
            $.getJSON('/connectionData.json', function(data) {
                connectionData = data;
            }).done(function() {
                google.charts.load('current', {
                    packages: ['corechart', 'line']
                });
                google.charts.setOnLoadCallback(drawChart);

                setInterval($.getJSON('/connectionData.json', function(newData) {
                    connectionData = newData;
                    drawChart();
                }), 60 * 1000 * 5);

            });
        });
    </script>

    <title>
    </title>
</head>

<body>
    <div id="chartContainer" style="height: 100%; width: 100%;">
    </div>
</body>

</html>